{"version":3,"sources":["const/cell-value.js","const/cell-state.js","utils/check-cell.js","components/Cell/Cell.js","components/Field/Field.js","components/Footer/Footer.js","components/Header/Header.js","hooks/use-did-update.js","view-models/cell-address-utils.js","view-models/cell-neighbors-utils.js","components/Indicators/Indicators.js","hooks/use-interval.js","components/Minesweeper/Minesweeper.js","hooks/use-field.js","App.js","setupIcons.js","index.js"],"names":["cellValue","cellState","Hidden","Visible","Flagged","checkCell","cell","prop","criteria","isMinedCell","isHiddenCell","isFlaggedCell","isBustedCell","Cell","memo","state","cellRevealHandler","flagPlantingHandler","neighborsRevealHandler","value","hasGuessedIncorrectly","hasBustedMine","className","onClick","onContextMenu","icon","onMouseDown","Field","width","disabled","handleNeighborsReveal","address","target","which","nativeEvent","addEventListener","handleMouseup","event","removeEventListener","style","gridTemplateColumns","preventDefault","map","key","Footer","href","rel","Date","getFullYear","Header","useDidUpdate","fn","fnRef","useRef","didMount","useEffect","current","deps","CellAddressUtils","fieldWidth","this","_fieldWidth","rowAddress","colAddress","CellNeighborsUtils","fieldHeight","_fieldHeight","_cellAddressUtils","getAddresses","some","adr","to2DAddresses","addresses","rowAddressOffset","colAddressOffset","rowAddressAhead","colAddressAhead","_doesAddressExist","push","to1DAddress","_getCountBy","getMinedCount","reduce","ac","Indicators","minesCount","smileyFaceClickHandler","shouldStartCountingSeconds","isBust","isVictory","useState","secondsCount","setSecondsCount","isCountingSeconds","setIsCountingSeconds","formatCount","count","delay","intervalId","setInterval","clearInterval","useInterval","actionType","reducer","type","payload","produce","draft","isInit","remainingMinesCount","increment","Minesweeper","fieldDimension","initialState","useReducer","dispatch","height","length","cellNeighborsUtils","emptyField","useMemo","Array","fill","field","setField","getFloodFilledField","draftFn","floodFill","cellAdr","canFloodFill","forEach","getBustedField","reset","init","difference","range","randomAddresses","Set","size","add","Math","random","revealCell","plantFlag","revealNeighbors","canRevealNeighbors","markMines","useField","reject","App","library","faGithub","faBomb","faFlag","faMeh","faFrown","faSmile","render","document","getElementById"],"mappings":"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","file":"static/js/main.d5e68d92.chunk.js","sourcesContent":["export const cellValue = {\r\n  BustedMine: -3,\r\n  IncorrectGuess: -2,\r\n  Mine: -1,\r\n  Empty: 0,\r\n  One: 1,\r\n  Two: 2,\r\n  Three: 3,\r\n  Four: 4,\r\n  Five: 5,\r\n  Six: 6,\r\n  Seven: 7,\r\n  Eight: 8,\r\n};\r\n","export const cellState = {\r\n  Hidden: 0,\r\n  Visible: 1,\r\n  Flagged: 2,\r\n};\r\n","import { cellState, cellValue } from 'const';\r\n\r\nconst checkCell = (cell, prop, criteria) => cell[prop] === criteria;\r\n\r\nexport const isMinedCell = cell => checkCell(cell, 'value', cellValue.Mine);\r\nexport const isHiddenCell = cell => checkCell(cell, 'state', cellState.Hidden);\r\nexport const isFlaggedCell = cell => checkCell(cell, 'state', cellState.Flagged);\r\nexport const isBustedCell = cell => checkCell(cell, 'value', cellValue.BustedMine);\r\n","import React, { memo } from 'react';\r\n\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\n\r\nimport { isBustedCell, isFlaggedCell, isHiddenCell, isMinedCell } from 'utils/check-cell';\r\n\r\nimport { cellValue } from 'const';\r\n\r\nimport './Cell.scss';\r\n\r\nexport const Cell = memo(({ state, cellRevealHandler, flagPlantingHandler, neighborsRevealHandler }) => {\r\n  const { value } = state;\r\n\r\n  const hasGuessedIncorrectly = value === cellValue.IncorrectGuess;\r\n  const hasBustedMine = isBustedCell(state);\r\n\r\n  if (isHiddenCell(state)) return <div\r\n    className='cell'\r\n    onClick={cellRevealHandler}\r\n    onContextMenu={flagPlantingHandler}\r\n  />;\r\n\r\n  if (isFlaggedCell(state)) return <div className='cell' onContextMenu={flagPlantingHandler}>\r\n    <FontAwesomeIcon icon={['far', 'flag']} />\r\n  </div>;\r\n\r\n  if (value === cellValue.Empty) return <div className='cell cell__visible' />;\r\n\r\n  if (isMinedCell(state) || hasGuessedIncorrectly || hasBustedMine) return <div\r\n    className={`cell ${hasGuessedIncorrectly ? 'cell__incorrect-guess' : hasBustedMine ? 'cell__busted-mine' : ''}`}\r\n  >\r\n    <FontAwesomeIcon icon={['fas', 'bomb']} />\r\n  </div>;\r\n\r\n  return <div className={`cell cell__visible cell__visible__${value}`} onMouseDown={neighborsRevealHandler}>\r\n    {value}\r\n  </div>;\r\n});\r\n","import React from 'react';\r\n\r\nimport { Cell } from '..';\r\n\r\nimport './Field.scss';\r\n\r\nexport const Field = ({ width, disabled, state, cellRevealHandler, flagPlantingHandler, neighborsRevealHandler }) => {\r\n  const handleNeighborsReveal = ({ target, nativeEvent: { which } }, address) => {\r\n    if (!disabled) {\r\n      const handleMouseup = event => {\r\n        which !== event.which && neighborsRevealHandler(address);\r\n\r\n        target.removeEventListener('mouseup', handleMouseup);\r\n      };\r\n\r\n      target.addEventListener('mouseup', handleMouseup);\r\n    }\r\n  };\r\n\r\n  return <div\r\n    className={`field${disabled ? ' disabled' : ''}`}\r\n    style={{gridTemplateColumns: `repeat(${width}, 1fr)`}}\r\n    onContextMenu={event => { event.preventDefault(); }}\r\n  >\r\n    {state.map((cell, address) => <Cell\r\n      key={address}\r\n      state={cell}\r\n      cellRevealHandler={() => { !disabled && cellRevealHandler(cell, address); }}\r\n      flagPlantingHandler={() => { !disabled && flagPlantingHandler(cell, address); }}\r\n      neighborsRevealHandler={event => { handleNeighborsReveal(event, address); }}\r\n    />)}\r\n  </div>;\r\n};\r\n","import React from 'react';\r\n\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\n\r\nimport './Footer.scss';\r\n\r\nexport const Footer = () => <footer>\r\n  <span>\r\n    Powered by\r\n    <a href='https://github.com/FakeMetalFan' target='_blank' rel='noopener noreferrer'>\r\n      <FontAwesomeIcon icon={['fab', 'github']} />\r\n    </a>\r\n    &copy;<span>{new Date().getFullYear()}</span>\r\n  </span>\r\n</footer>;\r\n","import React from 'react';\r\n\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\n\r\nimport './Header.scss';\r\n\r\nexport const Header = () => <header>\r\n  <span className='title'>Minesweeper</span>\r\n\r\n  <a href='https://github.com/FakeMetalFan/minesweeper' target='_blank' rel='noopener noreferrer'>\r\n    <FontAwesomeIcon icon={['fab', 'github']} />\r\n  </a>\r\n</header>;\r\n","import { useEffect, useRef } from 'react';\r\n\r\nexport const useDidUpdate = (fn, ...deps) => {\r\n  const fnRef = useRef();\r\n  const didMount = useRef(false);\r\n\r\n  useEffect(() => {\r\n    fnRef.current = fn;\r\n  }, [fn]);\r\n\r\n  useEffect(() => {\r\n    if (didMount.current) fnRef.current();\r\n    else didMount.current = true;\r\n  }, deps);\r\n};\r\n","export class CellAddressUtils {\r\n  _fieldWidth;\r\n\r\n  constructor(\r\n    fieldWidth\r\n  ) {\r\n    this._fieldWidth = fieldWidth;\r\n  }\r\n\r\n  to2DAddresses(address) {\r\n    const rowAddress = address % this._fieldWidth;\r\n\r\n    return [rowAddress, (address - rowAddress) / this._fieldWidth];\r\n  }\r\n\r\n  to1DAddress(rowAddress, colAddress) {\r\n    return colAddress * this._fieldWidth + rowAddress;\r\n  }\r\n}\r\n","import { isFlaggedCell, isMinedCell } from 'utils/check-cell';\r\n\r\nimport { CellAddressUtils } from './cell-address-utils';\r\n\r\nexport class CellNeighborsUtils {\r\n  _fieldWidth;\r\n  _fieldHeight;\r\n  _cellAddressUtils;\r\n\r\n  constructor(\r\n    fieldWidth,\r\n    fieldHeight\r\n  ) {\r\n    this._fieldWidth = fieldWidth;\r\n    this._fieldHeight = fieldHeight;\r\n    this._cellAddressUtils = new CellAddressUtils(fieldWidth);\r\n  }\r\n\r\n  canFloodFill(state, address) {\r\n    return !this.getAddresses(address).some(adr => {\r\n      const cell = state[adr];\r\n\r\n      return isMinedCell(cell) && !isFlaggedCell(cell);\r\n    });\r\n  }\r\n\r\n  getAddresses(address) {\r\n    const [rowAddress, colAddress] = this._cellAddressUtils.to2DAddresses(address);\r\n    const addresses = [];\r\n\r\n    for (let rowAddressOffset = -1; rowAddressOffset < 2; rowAddressOffset++)\r\n      for (let colAddressOffset = -1; colAddressOffset < 2; colAddressOffset++)\r\n        if (rowAddressOffset || colAddressOffset) {\r\n          const rowAddressAhead = rowAddress + rowAddressOffset;\r\n          const colAddressAhead = colAddress + colAddressOffset;\r\n\r\n          this._doesAddressExist(rowAddressAhead, this._fieldWidth)\r\n            && this._doesAddressExist(colAddressAhead, this._fieldHeight)\r\n              && addresses.push(this._cellAddressUtils.to1DAddress(rowAddressAhead, colAddressAhead));\r\n        }\r\n\r\n    return addresses;\r\n  }\r\n\r\n  getMinedCount(state, address) {\r\n    return this._getCountBy(state, address, isMinedCell);\r\n  }\r\n\r\n  canRevealNeighbors(state, address) {\r\n    return this.getMinedCount(state, address) === this._getCountBy(state, address, isFlaggedCell);\r\n  }\r\n\r\n  _getCountBy(state, address, criteria) {\r\n    return this.getAddresses(address).reduce((ac, adr) => criteria(state[adr]) ? ac + 1 : ac, 0);\r\n  }\r\n\r\n  _doesAddressExist(address, criteria) {\r\n    return -1 < address && address < criteria;\r\n  }\r\n}\r\n","import React, { useState } from 'react';\r\n\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\n\r\nimport { useDidUpdate, useInterval } from 'hooks';\r\n\r\nimport './Indicators.scss';\r\n\r\nexport const Indicators = ({ minesCount, smileyFaceClickHandler, shouldStartCountingSeconds, isBust, isVictory }) => {\r\n  const [secondsCount, setSecondsCount] = useState(0);\r\n  const [isCountingSeconds, setIsCountingSeconds] = useState(false);\r\n\r\n  const formatCount = count => {\r\n    if (count < 1) return '000';\r\n    if (count < 10) return `00${count}`;\r\n    if (count < 100) return `0${count}`;\r\n\r\n    return `${count}`;\r\n  };\r\n\r\n  const handleSmileyFaceClick = () => {\r\n    setIsCountingSeconds(false);\r\n    setSecondsCount(0);\r\n    smileyFaceClickHandler();\r\n  };\r\n\r\n  useDidUpdate(() => {\r\n    shouldStartCountingSeconds && setIsCountingSeconds(true);\r\n  }, shouldStartCountingSeconds);\r\n\r\n  useDidUpdate(() => {\r\n    (isBust || isVictory) && setIsCountingSeconds(false);\r\n  }, isBust, isVictory);\r\n\r\n  useInterval(() => {\r\n    setSecondsCount(secondsCount + 1);\r\n  }, isCountingSeconds ? 1e3 : null);\r\n\r\n  return <div className='indicators'>\r\n    <div className='mines-count'>{formatCount(minesCount)}</div>\r\n    <div className='smiley-face' onClick={handleSmileyFaceClick}>\r\n      <FontAwesomeIcon icon={['far', isVictory ? 'smile' : isBust ? 'frown' : 'meh']} />\r\n    </div>\r\n    <div className='timer'>{formatCount(secondsCount)}</div>\r\n  </div>;\r\n};\r\n","import { useEffect, useRef } from 'react';\r\n\r\nexport const useInterval = (fn, delay) => {\r\n  const fnRef = useRef();\r\n\r\n  useEffect(() => {\r\n    fnRef.current = fn;\r\n  }, [fn])\r\n\r\n  useEffect(() => {\r\n    if (delay) {\r\n      const intervalId = setInterval(() => {\r\n        fnRef.current();\r\n      }, delay);\r\n\r\n      return () => {\r\n        clearInterval(intervalId);\r\n      };\r\n    }\r\n  }, [delay]);\r\n};\r\n","import React, { useReducer } from 'react';\r\n\r\nimport produce from 'immer';\r\n\r\nimport reject from 'lodash/reject';\r\n\r\nimport { useField, useDidUpdate } from 'hooks';\r\n\r\nimport { isBustedCell, isFlaggedCell, isHiddenCell, isMinedCell } from 'utils/check-cell';\r\n\r\nimport { Field, Indicators } from '..';\r\n\r\nimport './Minesweeper.scss';\r\n\r\nconst actionType = {\r\n  UpdateIsInit: 'update-is-init',\r\n  UpdateRemainingMinesCount: 'update-remaining-mines-count',\r\n  Reset: 'reset',\r\n  UpdateIsBust: 'update-is-bust',\r\n  UpdateIsVictory: 'update-is-victory',\r\n};\r\n\r\nconst reducer = (state, { type, payload }) => type === actionType.Reset ? { ...payload } : produce(state, draft => {\r\n  switch (type) {\r\n    case actionType.UpdateIsInit:\r\n      draft.isInit = true;\r\n\r\n      break;\r\n    case actionType.UpdateRemainingMinesCount:\r\n      draft.remainingMinesCount += payload.increment;\r\n\r\n      break;\r\n    case actionType.UpdateIsBust:\r\n      draft.isBust = true;\r\n\r\n      break;\r\n    case actionType.UpdateIsVictory:\r\n      draft.remainingMinesCount = 0;\r\n      draft.isVictory = true;\r\n  }\r\n});\r\n\r\nexport const Minesweeper = ({ minesCount, fieldDimension }) => {\r\n  const initialState = { remainingMinesCount: minesCount, isInit: false, isBust: false, isVictory: false };\r\n\r\n  const [{ remainingMinesCount, isInit, isBust, isVictory }, dispatch] = useReducer(reducer, initialState);\r\n  const {\r\n    field,\r\n    reset,\r\n    init,\r\n    revealCell,\r\n    plantFlag,\r\n    revealNeighbors,\r\n    markMines,\r\n  } = useField({ minesCount, width: fieldDimension, height: fieldDimension });\r\n\r\n  const handleCellReveal = (cell, address) => {\r\n    if (isInit) revealCell(cell, address);\r\n    else {\r\n      init(address)\r\n      dispatch({ type: actionType.UpdateIsInit });\r\n    }\r\n  };\r\n\r\n  const handleFlagPlanting = (cell, address) => {\r\n    plantFlag(cell, address);\r\n    dispatch({ type: actionType.UpdateRemainingMinesCount, payload: { increment: isFlaggedCell(cell) ? 1 : -1 } });\r\n  };\r\n\r\n  const handleSmileyFaceClick = () => {\r\n    reset();\r\n    dispatch({ type: actionType.Reset, payload: initialState });\r\n  };\r\n\r\n  useDidUpdate(() => {\r\n    if (field.some(isBustedCell)) dispatch({ type: actionType.UpdateIsBust });\r\n    else if (!reject(field, isMinedCell).some(isHiddenCell)) {\r\n      markMines();\r\n      dispatch({ type: actionType.UpdateIsVictory });\r\n    }\r\n  }, field);\r\n\r\n  return <div className='minesweeper'>\r\n    <Indicators\r\n      minesCount={remainingMinesCount}\r\n      isBust={isBust}\r\n      isVictory={isVictory}\r\n      shouldStartCountingSeconds={isInit}\r\n      smileyFaceClickHandler={handleSmileyFaceClick}\r\n    />\r\n\r\n    <Field\r\n      width={fieldDimension}\r\n      disabled={isBust || isVictory}\r\n      state={field}\r\n      cellRevealHandler={handleCellReveal}\r\n      flagPlantingHandler={handleFlagPlanting}\r\n      neighborsRevealHandler={revealNeighbors}\r\n    />\r\n  </div>;\r\n};\r\n","import { useState, useMemo } from 'react';\r\n\r\nimport produce from 'immer';\r\n\r\nimport difference from 'lodash/difference';\r\nimport range from 'lodash/range';\r\n\r\nimport { cellState, cellValue } from 'const';\r\n\r\nimport { CellNeighborsUtils } from 'view-models';\r\n\r\nimport { isMinedCell, isHiddenCell, isFlaggedCell } from 'utils/check-cell';\r\n\r\nexport const useField = ({ width, height, minesCount }) => {\r\n  const length = width * height;\r\n  const cellNeighborsUtils = new CellNeighborsUtils(width, height);\r\n\r\n  const emptyField = useMemo(() => Array(length).fill({ value: cellValue.Empty, state: cellState.Hidden }), [length]);\r\n  const [field, setField] = useState(emptyField);\r\n\r\n  const getFloodFilledField = (address, draftFn) => produce(field, draft => {\r\n    /* eslint-disable-line */ draftFn?.(draft);\r\n    draft[address].state = cellState.Visible;\r\n\r\n    const floodFill = cellAdr => {\r\n      cellNeighborsUtils.canFloodFill(draft, cellAdr) && cellNeighborsUtils.getAddresses(cellAdr).forEach(adr => {\r\n        const cell = draft[adr];\r\n\r\n        if (!isMinedCell(cell) && isHiddenCell(cell) && !isFlaggedCell(cell)) {\r\n          cell.state = cellState.Visible;\r\n\r\n          floodFill(adr);\r\n        }\r\n      });\r\n    };\r\n\r\n    floodFill(address);\r\n  });\r\n\r\n  const getBustedField = draftFn => produce(field, draft => {\r\n    draftFn(draft);\r\n    draft.forEach((cell, adr) => {\r\n      isMinedCell(cell) && !isFlaggedCell(cell) && (cell.state = cellState.Visible);\r\n      !isMinedCell(cell) && isFlaggedCell(cell) && (draft[adr] = {\r\n        value: cellValue.IncorrectGuess,\r\n        state: cellState.Visible,\r\n      });\r\n    });\r\n  });\r\n\r\n  const reset = () => {\r\n    setField(emptyField);\r\n  };\r\n\r\n  const init = address => {\r\n    setField(getFloodFilledField(address, draft => {\r\n      const addresses = difference(range(length), [address, ...cellNeighborsUtils.getAddresses(address)]);\r\n      const randomAddresses = new Set;\r\n\r\n      while (randomAddresses.size < minesCount) randomAddresses.add(addresses[Math.random() * addresses.length | 0]);\r\n\r\n      randomAddresses.forEach(adr => {\r\n        draft[adr].value = cellValue.Mine;\r\n      });\r\n\r\n      draft.forEach((cell, adr) => {\r\n        !isMinedCell(cell) && (cell.value = cellNeighborsUtils.getMinedCount(draft, adr));\r\n      });\r\n    }));\r\n  };\r\n\r\n  const revealCell = (cell, address) => {\r\n    setField(isMinedCell(cell) ? getBustedField(draft => {\r\n      draft[address] = { value: cellValue.BustedMine, state: cellState.Visible };\r\n    }) : getFloodFilledField(address));\r\n  };\r\n\r\n  const plantFlag = (cell, address) => {\r\n    setField(produce(field, draft => {\r\n      draft[address].state = cellState[isFlaggedCell(cell) ? 'Hidden' : 'Flagged'];\r\n    }));\r\n  };\r\n\r\n  const revealNeighbors = address => {\r\n    if (cellNeighborsUtils.canFloodFill(field, address)) setField(getFloodFilledField(address));\r\n    else if (cellNeighborsUtils.canRevealNeighbors(field, address)) setField(getBustedField(draft => {\r\n      cellNeighborsUtils.getAddresses(address).forEach(adr => {\r\n        const cell = draft[adr];\r\n\r\n        isMinedCell(cell) && !isFlaggedCell(cell) && (cell.value = cellValue.BustedMine);\r\n        !isMinedCell(cell) && isFlaggedCell(cell) && (cell.value = cellValue.IncorrectGuess);\r\n\r\n        cell.state = cellState.Visible;\r\n      });\r\n    }));\r\n  };\r\n\r\n  const markMines = () => {\r\n    setField(produce(field, draft => {\r\n      draft.forEach(cell => {\r\n        isMinedCell(cell) && (cell.state = cellState.Flagged);\r\n      });\r\n    }));\r\n  };\r\n\r\n  return { field, reset, init, revealCell, plantFlag, revealNeighbors, markMines };\r\n};\r\n","import React from 'react';\r\n\r\nimport { Header, Minesweeper, Footer } from 'components';\r\n\r\nexport const App = () => <>\r\n  <Header />\r\n  <Minesweeper minesCount={30} fieldDimension={16} />\r\n  <Footer />\r\n</>;\r\n","import { library } from '@fortawesome/fontawesome-svg-core'\r\nimport { faGithub } from '@fortawesome/free-brands-svg-icons';\r\nimport { faFlag, faMeh, faFrown, faSmile } from '@fortawesome/free-regular-svg-icons';\r\nimport { faBomb } from '@fortawesome/free-solid-svg-icons';\r\n\r\nexport const setupIcons = () => {\r\n  library.add(faGithub, faBomb, faFlag, faMeh, faFrown, faSmile);\r\n};\r\n","import React, { StrictMode }  from 'react';\r\nimport { render } from 'react-dom';\r\n\r\nimport { App } from 'App';\r\n\r\nimport { setupIcons } from 'setupIcons';\r\n\r\nimport 'index.scss';\r\n\r\nsetupIcons();\r\n\r\nrender(\r\n  <StrictMode>\r\n    <App />\r\n  </StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}